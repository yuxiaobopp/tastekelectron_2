(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22cc91"],{f55a:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"gateway"}},[a("h2",[t._v(">>网关配置")]),a("Divider"),a("Button",{attrs:{type:"primary",icon:"md-add-circle"},on:{click:function(e){t.modal1=!0}}},[t._v("新建网关")]),a("Button",{attrs:{type:"warning",disabled:t.button_disabled},on:{click:t.del_confirm}},[t._v("删除")]),a("Modal",{attrs:{title:"Common Modal dialog box title",styles:{top:"150px"}},model:{value:t.modal1,callback:function(e){t.modal1=e},expression:"modal1"}},[a("p",{attrs:{slot:"header"},slot:"header"},[t._v("新建网关")]),a("Card",{attrs:{"dis-hover":"",bordered:!1}},[a("Form",{ref:"formValidate",attrs:{model:t.formValidate,rules:t.ruleValidate}},[a("FormItem",{attrs:{label:"网关名称",prop:"gateway_name"}},[a("Input",{attrs:{placeholder:"名称必须唯一"},model:{value:t.formValidate.gateway_name,callback:function(e){t.$set(t.formValidate,"gateway_name",e)},expression:"formValidate.gateway_name"}})],1),a("FormItem",{attrs:{label:"描述",prop:"description"}},[a("Input",{attrs:{type:"textarea",rows:4,placeholder:"请填写描述信息"},model:{value:t.formValidate.description,callback:function(e){t.$set(t.formValidate,"description",e)},expression:"formValidate.description"}})],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:function(e){return t.handleSubmit("formValidate")}}},[t._v("确定")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleReset("formValidate")}}},[t._v("重置")])],1)],1),a("Modal",{attrs:{width:"360"},model:{value:t.modal2,callback:function(e){t.modal2=e},expression:"modal2"}},[a("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[a("Icon",{attrs:{type:"ios-information-circle"}}),a("span",[t._v("Delete confirmation")])],1),a("div",{staticStyle:{"text-align":"center"}},[a("p",[t._v("删除网关"+t._s(t.$store.state.current_gateway)+"其子设备也一并删除")]),a("p",[t._v("是否继续？")])]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"error",size:"large",long:""},on:{click:t.remove}},[t._v("删除")])],1)]),a("Divider"),a("v-gatewaylist",{ref:"gatewaylist"})],1)},l=[],o=(a("7f7f"),a("66df")),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Table",{ref:"selection",attrs:{border:"",stripe:"",columns:t.columns7,data:t.data6},on:{"on-select":t.handleSelect,"on-select-cancel":t.handleCancle}}),a("br"),a("Button",{on:{click:function(e){return t.handleSelectAll(!0)}}},[t._v("全选")]),a("Button",{on:{click:function(e){return t.handleSelectAll(!1)}}},[t._v("取消全选")])],1)},i=[],s={name:"gatewayList",data:function(){var t=this;return{modal2:!1,columns7:[{type:"selection",width:60,align:"center"},{title:"名称",key:"gateway_name",sortable:!0},{title:"描述",key:"description"},{title:"子设备数",key:"sub_device",sortable:!0,width:130,align:"center"},{title:"创建时间",key:"create_date",width:150,align:"center",sortable:!0},{title:"管理",key:"aa",width:150,align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"primary"},style:{width:"80%",marginLeft:"0px"},on:{click:function(){t.$store.commit("change_gateway",a.row.gateway_name),t.$router.push({path:"/device/device_manage"})}}},"管理子设备")])}}],data6:[]}},methods:{handleSelectAll:function(t){if(this.$refs.selection.selectAll(t),1==t)for(var e in this.data6)this.$parent.gateway_list.push(e.gateway_name);else this.$parent.gateway_list=[]},handleSelect:function(t,e){this.$parent.gateway_list.push(e.gateway_name)},handleCancle:function(t,e){var a=this.$parent.gateway_list;for(var n in a)if(a[n]==e.gateway_name)return void this.$parent.gateway_list.splice(n,1)},get_all_gateway:function(){var t=this;o["a"].request({url:"api/gateway/getAll"}).then(function(e){console.log(e.data),"ok"==e.data.msg&&(t.data6=e.data.data),t.$store.commit("update_gateway_list",e.data.data)}).catch(function(t){console.log("get all gateway fail"),console.log(t)})}},mounted:function(){this.get_all_gateway()}},c=s,d=a("2877"),u=Object(d["a"])(c,r,i,!1,null,null,null),m=u.exports,g={data:function(){return{gateway_list:[],modal1:!1,modal2:!1,formValidate:{gateway_name:"",description:""},ruleValidate:{gateway_name:[{required:!0,message:"The id cannot be empty",trigger:"blur"}],description:[{required:!0,message:"Description cannot be empty",trigger:"blur"}]}}},components:{"v-gatewaylist":m},computed:{button_disabled:function(){return!(this.gateway_list.length>0)}},methods:{handleSubmit:function(t){var e=this;this.$refs[t].validate(function(t){if(t){var a=e.$refs.gatewaylist.data6;for(var n in a)if(a[n].gateway_name==e.formValidate.gateway_name)return void e.$Message.error("网关名称已存在！");o["a"].request({url:"api/gateway/new",method:"post",data:{gateway_name:e.formValidate.gateway_name,description:e.formValidate.description}}).then(function(t){"ok"===t.data.msg?(e.modal1=!1,e.$Message.success("创建成功！"),e.$refs.gatewaylist.get_all_gateway(),e.formValidate={gateway_name:"",description:""}):e.$Message.error("创建失败1！")}).catch(function(t){e.modal1=!0,console.log(t),e.$Message.error("创建失败2！")})}else e.$Message.error("Fail!")})},del_confirm:function(){this.modal2=!0},remove:function(){var t=this;o["a"].request({url:"api/gateway/delate",method:"post",data:{name:this.gateway_list}}).then(function(e){"ok"===e.data.msg?(t.$Message.success("删除成功！"),t.$refs.gatewaylist.get_all_gateway(),t.gateway_list=[],t.modal2=!1):t.$Message.error("删除失败！"),t.modal2=!1}).catch(function(e){console.log(e),t.modal2=!1})},handleReset:function(t){this.$refs[t].resetFields()}}},f=g,p=Object(d["a"])(f,n,l,!1,null,null,null);e["default"]=p.exports}}]);